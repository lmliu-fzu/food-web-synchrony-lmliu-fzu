data=read.table("data.txt",row.names=1,header=T)

# Define the Loreau synchronicity index calculation function
calc_loreau <- function(data_window) {
    cov_mat <- apply(data_window, 2, sd)
    var_sum <- (sum(cov_mat))^2
    col_sums <- var(rowSums(data_window))         
    return <- col_sums/var_sum
}

# Sliding window calculation
sliding_loreau <- function(data, window_size = 100, step = 10, start_pos = 1) {
  n <- nrow(data)
  results <- list()
  pos <- start_pos
  
  while(pos + window_size - 1 <= n) {
    window_data <- data[pos:(pos + window_size - 1), ]
    sync_index <- calc_loreau(window_data)
    results[[length(results) + 1]] <- data.frame(
      start = pos,
      end = pos + window_size - 1,
      sync_index = sync_index
    )
    pos <- pos + step
  }
  
  return(do.call(rbind, results))
}

X2X3 <- as.matrix(data[, c("X2","X3")])
X2X4 <- as.matrix(data[, c("X2","X4")])
X2X5 <- as.matrix(data[, c("X2","X5")])
X2X6 <- as.matrix(data[, c("X2","X6")])
X2X7 <- as.matrix(data[, c("X2","X7")])
X2X8 <- as.matrix(data[, c("X2","X8")])
X2X9 <- as.matrix(data[, c("X2","X9")])
X2X10 <- as.matrix(data[, c("X2","X10")])
X2X11 <- as.matrix(data[, c("X2","X11")])
X2X12 <- as.matrix(data[, c("X2","X12")])
X2X13 <- as.matrix(data[, c("X2","X13")])
X2X14 <- as.matrix(data[, c("X2","X14")])
X2X15 <- as.matrix(data[, c("X2","X15")])
X2X16 <- as.matrix(data[, c("X2","X16")])
X2X17 <- as.matrix(data[, c("X2","X17")])
X2X18 <- as.matrix(data[, c("X2","X18")])
X2X19 <- as.matrix(data[, c("X2","X19")])
X2X20 <- as.matrix(data[, c("X2","X20")])
X2X21 <- as.matrix(data[, c("X2","X21")])
X2X22 <- as.matrix(data[, c("X2","X22")])
X2X23 <- as.matrix(data[, c("X2","X23")])
X2X24 <- as.matrix(data[, c("X2","X24")])
X2X25 <- as.matrix(data[, c("X2","X25")])
X2X26 <- as.matrix(data[, c("X2","X26")])
X2X27 <- as.matrix(data[, c("X2","X27")])
X3X4 <- as.matrix(data[, c("X3","X4")])
X3X5 <- as.matrix(data[, c("X3","X5")])
X3X6 <- as.matrix(data[, c("X3","X6")])
X3X7 <- as.matrix(data[, c("X3","X7")])
X3X8 <- as.matrix(data[, c("X3","X8")])
X3X9 <- as.matrix(data[, c("X3","X9")])
X3X10 <- as.matrix(data[, c("X3","X10")])
X3X11 <- as.matrix(data[, c("X3","X11")])
X3X12 <- as.matrix(data[, c("X3","X12")])
X3X13 <- as.matrix(data[, c("X3","X13")])
X3X14 <- as.matrix(data[, c("X3","X14")])
X3X15 <- as.matrix(data[, c("X3","X15")])
X3X16 <- as.matrix(data[, c("X3","X16")])
X3X17 <- as.matrix(data[, c("X3","X17")])
X3X18 <- as.matrix(data[, c("X3","X18")])
X3X19 <- as.matrix(data[, c("X3","X19")])
X3X20 <- as.matrix(data[, c("X3","X20")])
X3X21 <- as.matrix(data[, c("X3","X21")])
X3X22 <- as.matrix(data[, c("X3","X22")])
X3X23 <- as.matrix(data[, c("X3","X23")])
X3X24 <- as.matrix(data[, c("X3","X24")])
X3X25 <- as.matrix(data[, c("X3","X25")])
X3X26 <- as.matrix(data[, c("X3","X26")])
X3X27 <- as.matrix(data[, c("X3","X27")])
X4X5 <- as.matrix(data[, c("X4","X5")])
X4X6 <- as.matrix(data[, c("X4","X6")])
X4X7 <- as.matrix(data[, c("X4","X7")])
X4X8 <- as.matrix(data[, c("X4","X8")])
X4X9 <- as.matrix(data[, c("X4","X9")])
X4X10 <- as.matrix(data[, c("X4","X10")])
X4X11 <- as.matrix(data[, c("X4","X11")])
X4X12 <- as.matrix(data[, c("X4","X12")])
X4X13 <- as.matrix(data[, c("X4","X13")])
X4X14 <- as.matrix(data[, c("X4","X14")])
X4X15 <- as.matrix(data[, c("X4","X15")])
X4X16 <- as.matrix(data[, c("X4","X16")])
X4X17 <- as.matrix(data[, c("X4","X17")])
X4X18 <- as.matrix(data[, c("X4","X18")])
X4X19 <- as.matrix(data[, c("X4","X19")])
X4X20 <- as.matrix(data[, c("X4","X20")])
X4X21 <- as.matrix(data[, c("X4","X21")])
X4X22 <- as.matrix(data[, c("X4","X22")])
X4X23 <- as.matrix(data[, c("X4","X23")])
X4X24 <- as.matrix(data[, c("X4","X24")])
X4X25 <- as.matrix(data[, c("X4","X25")])
X4X26 <- as.matrix(data[, c("X4","X26")])
X4X27 <- as.matrix(data[, c("X4","X27")])
X5X6 <- as.matrix(data[, c("X5","X6")])
X5X7 <- as.matrix(data[, c("X5","X7")])
X5X8 <- as.matrix(data[, c("X5","X8")])
X5X9 <- as.matrix(data[, c("X5","X9")])
X5X10 <- as.matrix(data[, c("X5","X10")])
X5X11 <- as.matrix(data[, c("X5","X11")])
X5X12 <- as.matrix(data[, c("X5","X12")])
X5X13 <- as.matrix(data[, c("X5","X13")])
X5X14 <- as.matrix(data[, c("X5","X14")])
X5X15 <- as.matrix(data[, c("X5","X15")])
X5X16 <- as.matrix(data[, c("X5","X16")])
X5X17 <- as.matrix(data[, c("X5","X17")])
X5X18 <- as.matrix(data[, c("X5","X18")])
X5X19 <- as.matrix(data[, c("X5","X19")])
X5X20 <- as.matrix(data[, c("X5","X20")])
X5X21 <- as.matrix(data[, c("X5","X21")])
X5X22 <- as.matrix(data[, c("X5","X22")])
X5X23 <- as.matrix(data[, c("X5","X23")])
X5X24 <- as.matrix(data[, c("X5","X24")])
X5X25 <- as.matrix(data[, c("X5","X25")])
X5X26 <- as.matrix(data[, c("X5","X26")])
X5X27 <- as.matrix(data[, c("X5","X27")])
X6X7 <- as.matrix(data[, c("X6","X7")])
X6X8 <- as.matrix(data[, c("X6","X8")])
X6X9 <- as.matrix(data[, c("X6","X9")])
X6X10 <- as.matrix(data[, c("X6","X10")])
X6X11 <- as.matrix(data[, c("X6","X11")])
X6X12 <- as.matrix(data[, c("X6","X12")])
X6X13 <- as.matrix(data[, c("X6","X13")])
X6X14 <- as.matrix(data[, c("X6","X14")])
X6X15 <- as.matrix(data[, c("X6","X15")])
X6X16 <- as.matrix(data[, c("X6","X16")])
X6X17 <- as.matrix(data[, c("X6","X17")])
X6X18 <- as.matrix(data[, c("X6","X18")])
X6X19 <- as.matrix(data[, c("X6","X19")])
X6X20 <- as.matrix(data[, c("X6","X20")])
X6X21 <- as.matrix(data[, c("X6","X21")])
X6X22 <- as.matrix(data[, c("X6","X22")])
X6X23 <- as.matrix(data[, c("X6","X23")])
X6X24 <- as.matrix(data[, c("X6","X24")])
X6X25 <- as.matrix(data[, c("X6","X25")])
X6X26 <- as.matrix(data[, c("X6","X26")])
X6X27 <- as.matrix(data[, c("X6","X27")])
X7X8 <- as.matrix(data[, c("X7","X8")])
X7X9 <- as.matrix(data[, c("X7","X9")])
X7X10 <- as.matrix(data[, c("X7","X10")])
X7X11 <- as.matrix(data[, c("X7","X11")])
X7X12 <- as.matrix(data[, c("X7","X12")])
X7X13 <- as.matrix(data[, c("X7","X13")])
X7X14 <- as.matrix(data[, c("X7","X14")])
X7X15 <- as.matrix(data[, c("X7","X15")])
X7X16 <- as.matrix(data[, c("X7","X16")])
X7X17 <- as.matrix(data[, c("X7","X17")])
X7X18 <- as.matrix(data[, c("X7","X18")])
X7X19 <- as.matrix(data[, c("X7","X19")])
X7X20 <- as.matrix(data[, c("X7","X20")])
X7X21 <- as.matrix(data[, c("X7","X21")])
X7X22 <- as.matrix(data[, c("X7","X22")])
X7X23 <- as.matrix(data[, c("X7","X23")])
X7X24 <- as.matrix(data[, c("X7","X24")])
X7X25 <- as.matrix(data[, c("X7","X25")])
X7X26 <- as.matrix(data[, c("X7","X26")])
X7X27 <- as.matrix(data[, c("X7","X27")])
X8X9 <- as.matrix(data[, c("X8","X9")])
X8X10 <- as.matrix(data[, c("X8","X10")])
X8X11 <- as.matrix(data[, c("X8","X11")])
X8X12 <- as.matrix(data[, c("X8","X12")])
X8X13 <- as.matrix(data[, c("X8","X13")])
X8X14 <- as.matrix(data[, c("X8","X14")])
X8X15 <- as.matrix(data[, c("X8","X15")])
X8X16 <- as.matrix(data[, c("X8","X16")])
X8X17 <- as.matrix(data[, c("X8","X17")])
X8X18 <- as.matrix(data[, c("X8","X18")])
X8X19 <- as.matrix(data[, c("X8","X19")])
X8X20 <- as.matrix(data[, c("X8","X20")])
X8X21 <- as.matrix(data[, c("X8","X21")])
X8X22 <- as.matrix(data[, c("X8","X22")])
X8X23 <- as.matrix(data[, c("X8","X23")])
X8X24 <- as.matrix(data[, c("X8","X24")])
X8X25 <- as.matrix(data[, c("X8","X25")])
X8X26 <- as.matrix(data[, c("X8","X26")])
X8X27 <- as.matrix(data[, c("X8","X27")])
X9X10 <- as.matrix(data[, c("X9","X10")])
X9X11 <- as.matrix(data[, c("X9","X11")])
X9X12 <- as.matrix(data[, c("X9","X12")])
X9X13 <- as.matrix(data[, c("X9","X13")])
X9X14 <- as.matrix(data[, c("X9","X14")])
X9X15 <- as.matrix(data[, c("X9","X15")])
X9X16 <- as.matrix(data[, c("X9","X16")])
X9X17 <- as.matrix(data[, c("X9","X17")])
X9X18 <- as.matrix(data[, c("X9","X18")])
X9X19 <- as.matrix(data[, c("X9","X19")])
X9X20 <- as.matrix(data[, c("X9","X20")])
X9X21 <- as.matrix(data[, c("X9","X21")])
X9X22 <- as.matrix(data[, c("X9","X22")])
X9X23 <- as.matrix(data[, c("X9","X23")])
X9X24 <- as.matrix(data[, c("X9","X24")])
X9X25 <- as.matrix(data[, c("X9","X25")])
X9X26 <- as.matrix(data[, c("X9","X26")])
X9X27 <- as.matrix(data[, c("X9","X27")])
X10X11 <- as.matrix(data[, c("X10","X11")])
X10X12 <- as.matrix(data[, c("X10","X12")])
X10X13 <- as.matrix(data[, c("X10","X13")])
X10X14 <- as.matrix(data[, c("X10","X14")])
X10X15 <- as.matrix(data[, c("X10","X15")])
X10X16 <- as.matrix(data[, c("X10","X16")])
X10X17 <- as.matrix(data[, c("X10","X17")])
X10X18 <- as.matrix(data[, c("X10","X18")])
X10X19 <- as.matrix(data[, c("X10","X19")])
X10X20 <- as.matrix(data[, c("X10","X20")])
X10X21 <- as.matrix(data[, c("X10","X21")])
X10X22 <- as.matrix(data[, c("X10","X22")])
X10X23 <- as.matrix(data[, c("X10","X23")])
X10X24 <- as.matrix(data[, c("X10","X24")])
X10X25 <- as.matrix(data[, c("X10","X25")])
X10X26 <- as.matrix(data[, c("X10","X26")])
X10X27 <- as.matrix(data[, c("X10","X27")])
X11X12 <- as.matrix(data[, c("X11","X12")])
X11X13 <- as.matrix(data[, c("X11","X13")])
X11X14 <- as.matrix(data[, c("X11","X14")])
X11X15 <- as.matrix(data[, c("X11","X15")])
X11X16 <- as.matrix(data[, c("X11","X16")])
X11X17 <- as.matrix(data[, c("X11","X17")])
X11X18 <- as.matrix(data[, c("X11","X18")])
X11X19 <- as.matrix(data[, c("X11","X19")])
X11X20 <- as.matrix(data[, c("X11","X20")])
X11X21 <- as.matrix(data[, c("X11","X21")])
X11X22 <- as.matrix(data[, c("X11","X22")])
X11X23 <- as.matrix(data[, c("X11","X23")])
X11X24 <- as.matrix(data[, c("X11","X24")])
X11X25 <- as.matrix(data[, c("X11","X25")])
X11X26 <- as.matrix(data[, c("X11","X26")])
X11X27 <- as.matrix(data[, c("X11","X27")])
X12X13 <- as.matrix(data[, c("X12","X13")])
X12X14 <- as.matrix(data[, c("X12","X14")])
X12X15 <- as.matrix(data[, c("X12","X15")])
X12X16 <- as.matrix(data[, c("X12","X16")])
X12X17 <- as.matrix(data[, c("X12","X17")])
X12X18 <- as.matrix(data[, c("X12","X18")])
X12X19 <- as.matrix(data[, c("X12","X19")])
X12X20 <- as.matrix(data[, c("X12","X20")])
X12X21 <- as.matrix(data[, c("X12","X21")])
X12X22 <- as.matrix(data[, c("X12","X22")])
X12X23 <- as.matrix(data[, c("X12","X23")])
X12X24 <- as.matrix(data[, c("X12","X24")])
X12X25 <- as.matrix(data[, c("X12","X25")])
X12X26 <- as.matrix(data[, c("X12","X26")])
X12X27 <- as.matrix(data[, c("X12","X27")])
X13X14 <- as.matrix(data[, c("X13","X14")])
X13X15 <- as.matrix(data[, c("X13","X15")])
X13X16 <- as.matrix(data[, c("X13","X16")])
X13X17 <- as.matrix(data[, c("X13","X17")])
X13X18 <- as.matrix(data[, c("X13","X18")])
X13X19 <- as.matrix(data[, c("X13","X19")])
X13X20 <- as.matrix(data[, c("X13","X20")])
X13X21 <- as.matrix(data[, c("X13","X21")])
X13X22 <- as.matrix(data[, c("X13","X22")])
X13X23 <- as.matrix(data[, c("X13","X23")])
X13X24 <- as.matrix(data[, c("X13","X24")])
X13X25 <- as.matrix(data[, c("X13","X25")])
X13X26 <- as.matrix(data[, c("X13","X26")])
X13X27 <- as.matrix(data[, c("X13","X27")])
X14X15 <- as.matrix(data[, c("X14","X15")])
X14X16 <- as.matrix(data[, c("X14","X16")])
X14X17 <- as.matrix(data[, c("X14","X17")])
X14X18 <- as.matrix(data[, c("X14","X18")])
X14X19 <- as.matrix(data[, c("X14","X19")])
X14X20 <- as.matrix(data[, c("X14","X20")])
X14X21 <- as.matrix(data[, c("X14","X21")])
X14X22 <- as.matrix(data[, c("X14","X22")])
X14X23 <- as.matrix(data[, c("X14","X23")])
X14X24 <- as.matrix(data[, c("X14","X24")])
X14X25 <- as.matrix(data[, c("X14","X25")])
X14X26 <- as.matrix(data[, c("X14","X26")])
X14X27 <- as.matrix(data[, c("X14","X27")])
X15X16 <- as.matrix(data[, c("X15","X16")])
X15X17 <- as.matrix(data[, c("X15","X17")])
X15X18 <- as.matrix(data[, c("X15","X18")])
X15X19 <- as.matrix(data[, c("X15","X19")])
X15X20 <- as.matrix(data[, c("X15","X20")])
X15X21 <- as.matrix(data[, c("X15","X21")])
X15X22 <- as.matrix(data[, c("X15","X22")])
X15X23 <- as.matrix(data[, c("X15","X23")])
X15X24 <- as.matrix(data[, c("X15","X24")])
X15X25 <- as.matrix(data[, c("X15","X25")])
X15X26 <- as.matrix(data[, c("X15","X26")])
X15X27 <- as.matrix(data[, c("X15","X27")])
X16X17 <- as.matrix(data[, c("X16","X17")])
X16X18 <- as.matrix(data[, c("X16","X18")])
X16X19 <- as.matrix(data[, c("X16","X19")])
X16X20 <- as.matrix(data[, c("X16","X20")])
X16X21 <- as.matrix(data[, c("X16","X21")])
X16X22 <- as.matrix(data[, c("X16","X22")])
X16X23 <- as.matrix(data[, c("X16","X23")])
X16X24 <- as.matrix(data[, c("X16","X24")])
X16X25 <- as.matrix(data[, c("X16","X25")])
X16X26 <- as.matrix(data[, c("X16","X26")])
X16X27 <- as.matrix(data[, c("X16","X27")])
X17X18 <- as.matrix(data[, c("X17","X18")])
X17X19 <- as.matrix(data[, c("X17","X19")])
X17X20 <- as.matrix(data[, c("X17","X20")])
X17X21 <- as.matrix(data[, c("X17","X21")])
X17X22 <- as.matrix(data[, c("X17","X22")])
X17X23 <- as.matrix(data[, c("X17","X23")])
X17X24 <- as.matrix(data[, c("X17","X24")])
X17X25 <- as.matrix(data[, c("X17","X25")])
X17X26 <- as.matrix(data[, c("X17","X26")])
X17X27 <- as.matrix(data[, c("X17","X27")])
X18X19 <- as.matrix(data[, c("X18","X19")])
X18X20 <- as.matrix(data[, c("X18","X20")])
X18X21 <- as.matrix(data[, c("X18","X21")])
X18X22 <- as.matrix(data[, c("X18","X22")])
X18X23 <- as.matrix(data[, c("X18","X23")])
X18X24 <- as.matrix(data[, c("X18","X24")])
X18X25 <- as.matrix(data[, c("X18","X25")])
X18X26 <- as.matrix(data[, c("X18","X26")])
X18X27 <- as.matrix(data[, c("X18","X27")])
X19X20 <- as.matrix(data[, c("X19","X20")])
X19X21 <- as.matrix(data[, c("X19","X21")])
X19X22 <- as.matrix(data[, c("X19","X22")])
X19X23 <- as.matrix(data[, c("X19","X23")])
X19X24 <- as.matrix(data[, c("X19","X24")])
X19X25 <- as.matrix(data[, c("X19","X25")])
X19X26 <- as.matrix(data[, c("X19","X26")])
X19X27 <- as.matrix(data[, c("X19","X27")])
X20X21 <- as.matrix(data[, c("X20","X21")])
X20X22 <- as.matrix(data[, c("X20","X22")])
X20X23 <- as.matrix(data[, c("X20","X23")])
X20X24 <- as.matrix(data[, c("X20","X24")])
X20X25 <- as.matrix(data[, c("X20","X25")])
X20X26 <- as.matrix(data[, c("X20","X26")])
X20X27 <- as.matrix(data[, c("X20","X27")])
X21X22 <- as.matrix(data[, c("X21","X22")])
X21X23 <- as.matrix(data[, c("X21","X23")])
X21X24 <- as.matrix(data[, c("X21","X24")])
X21X25 <- as.matrix(data[, c("X21","X25")])
X21X26 <- as.matrix(data[, c("X21","X26")])
X21X27 <- as.matrix(data[, c("X21","X27")])
X22X23 <- as.matrix(data[, c("X22","X23")])
X22X24 <- as.matrix(data[, c("X22","X24")])
X22X25 <- as.matrix(data[, c("X22","X25")])
X22X26 <- as.matrix(data[, c("X22","X26")])
X22X27 <- as.matrix(data[, c("X22","X27")])
X23X24 <- as.matrix(data[, c("X23","X24")])
X23X25 <- as.matrix(data[, c("X23","X25")])
X23X26 <- as.matrix(data[, c("X23","X26")])
X23X27 <- as.matrix(data[, c("X23","X27")])
X24X25 <- as.matrix(data[, c("X24","X25")])
X24X26 <- as.matrix(data[, c("X24","X26")])
X24X27 <- as.matrix(data[, c("X24","X27")])
X25X26 <- as.matrix(data[, c("X25","X26")])
X25X27 <- as.matrix(data[, c("X25","X27")])
X26X27 <- as.matrix(data[, c("X26","X27")])

result1 <- sliding_loreau(X2X3, 100, 10, 1)
result2 <- sliding_loreau(X2X4, 100, 10, 1)
result3 <- sliding_loreau(X2X5, 100, 10, 1)
result4 <- sliding_loreau(X2X6, 100, 10, 1)
result5 <- sliding_loreau(X2X7, 100, 10, 1)
result6 <- sliding_loreau(X2X8, 100, 10, 1)
result7 <- sliding_loreau(X2X9, 100, 10, 1)
result8 <- sliding_loreau(X2X10, 100, 10, 1)
result9 <- sliding_loreau(X2X11, 100, 10, 1)
result10 <- sliding_loreau(X2X12, 100, 10, 1)
result11 <- sliding_loreau(X2X13, 100, 10, 1)
result12 <- sliding_loreau(X2X14, 100, 10, 1)
result13 <- sliding_loreau(X2X15, 100, 10, 1)
result14 <- sliding_loreau(X2X16, 100, 10, 1)
result15 <- sliding_loreau(X2X17, 100, 10, 1)
result16 <- sliding_loreau(X2X18, 100, 10, 1)
result17 <- sliding_loreau(X2X19, 100, 10, 1)
result18 <- sliding_loreau(X2X20, 100, 10, 1)
result19 <- sliding_loreau(X2X21, 100, 10, 1)
result20 <- sliding_loreau(X2X22, 100, 10, 1)
result21 <- sliding_loreau(X2X23, 100, 10, 1)
result22 <- sliding_loreau(X2X24, 100, 10, 1)
result23 <- sliding_loreau(X2X25, 100, 10, 1)
result24 <- sliding_loreau(X2X26, 100, 10, 1)
result25 <- sliding_loreau(X2X27, 100, 10, 1)
result26 <- sliding_loreau(X3X4, 100, 10, 1)
result27 <- sliding_loreau(X3X5, 100, 10, 1)
result28 <- sliding_loreau(X3X6, 100, 10, 1)
result29 <- sliding_loreau(X3X7, 100, 10, 1)
result30 <- sliding_loreau(X3X8, 100, 10, 1)
result31 <- sliding_loreau(X3X9, 100, 10, 1)
result32 <- sliding_loreau(X3X10, 100, 10, 1)
result33 <- sliding_loreau(X3X11, 100, 10, 1)
result34 <- sliding_loreau(X3X12, 100, 10, 1)
result35 <- sliding_loreau(X3X13, 100, 10, 1)
result36 <- sliding_loreau(X3X14, 100, 10, 1)
result37 <- sliding_loreau(X3X15, 100, 10, 1)
result38 <- sliding_loreau(X3X16, 100, 10, 1)
result39 <- sliding_loreau(X3X17, 100, 10, 1)
result40 <- sliding_loreau(X3X18, 100, 10, 1)
result41 <- sliding_loreau(X3X19, 100, 10, 1)
result42 <- sliding_loreau(X3X20, 100, 10, 1)
result43 <- sliding_loreau(X3X21, 100, 10, 1)
result44 <- sliding_loreau(X3X22, 100, 10, 1)
result45 <- sliding_loreau(X3X23, 100, 10, 1)
result46 <- sliding_loreau(X3X24, 100, 10, 1)
result47 <- sliding_loreau(X3X25, 100, 10, 1)
result48 <- sliding_loreau(X3X26, 100, 10, 1)
result49 <- sliding_loreau(X3X27, 100, 10, 1)
result50 <- sliding_loreau(X4X5, 100, 10, 1)
result51 <- sliding_loreau(X4X6, 100, 10, 1)
result52 <- sliding_loreau(X4X7, 100, 10, 1)
result53 <- sliding_loreau(X4X8, 100, 10, 1)
result54 <- sliding_loreau(X4X9, 100, 10, 1)
result55 <- sliding_loreau(X4X10, 100, 10, 1)
result56 <- sliding_loreau(X4X11, 100, 10, 1)
result57 <- sliding_loreau(X4X12, 100, 10, 1)
result58 <- sliding_loreau(X4X13, 100, 10, 1)
result59 <- sliding_loreau(X4X14, 100, 10, 1)
result60 <- sliding_loreau(X4X15, 100, 10, 1)
result61 <- sliding_loreau(X4X16, 100, 10, 1)
result62 <- sliding_loreau(X4X17, 100, 10, 1)
result63 <- sliding_loreau(X4X18, 100, 10, 1)
result64 <- sliding_loreau(X4X19, 100, 10, 1)
result65 <- sliding_loreau(X4X20, 100, 10, 1)
result66 <- sliding_loreau(X4X21, 100, 10, 1)
result67 <- sliding_loreau(X4X22, 100, 10, 1)
result68 <- sliding_loreau(X4X23, 100, 10, 1)
result69 <- sliding_loreau(X4X24, 100, 10, 1)
result70 <- sliding_loreau(X4X25, 100, 10, 1)
result71 <- sliding_loreau(X4X26, 100, 10, 1)
result72 <- sliding_loreau(X4X27, 100, 10, 1)
result73 <- sliding_loreau(X5X6, 100, 10, 1)
result74 <- sliding_loreau(X5X7, 100, 10, 1)
result75 <- sliding_loreau(X5X8, 100, 10, 1)
result76 <- sliding_loreau(X5X9, 100, 10, 1)
result77 <- sliding_loreau(X5X10, 100, 10, 1)
result78 <- sliding_loreau(X5X11, 100, 10, 1)
result79 <- sliding_loreau(X5X12, 100, 10, 1)
result80 <- sliding_loreau(X5X13, 100, 10, 1)
result81 <- sliding_loreau(X5X14, 100, 10, 1)
result82 <- sliding_loreau(X5X15, 100, 10, 1)
result83 <- sliding_loreau(X5X16, 100, 10, 1)
result84 <- sliding_loreau(X5X17, 100, 10, 1)
result85 <- sliding_loreau(X5X18, 100, 10, 1)
result86 <- sliding_loreau(X5X19, 100, 10, 1)
result87 <- sliding_loreau(X5X20, 100, 10, 1)
result88 <- sliding_loreau(X5X21, 100, 10, 1)
result89 <- sliding_loreau(X5X22, 100, 10, 1)
result90 <- sliding_loreau(X5X23, 100, 10, 1)
result91 <- sliding_loreau(X5X24, 100, 10, 1)
result92 <- sliding_loreau(X5X25, 100, 10, 1)
result93 <- sliding_loreau(X5X26, 100, 10, 1)
result94 <- sliding_loreau(X5X27, 100, 10, 1)
result95 <- sliding_loreau(X6X7, 100, 10, 1)
result96 <- sliding_loreau(X6X8, 100, 10, 1)
result97 <- sliding_loreau(X6X9, 100, 10, 1)
result98 <- sliding_loreau(X6X10, 100, 10, 1)
result99 <- sliding_loreau(X6X11, 100, 10, 1)
result100 <- sliding_loreau(X6X12, 100, 10, 1)
result101 <- sliding_loreau(X6X13, 100, 10, 1)
result102 <- sliding_loreau(X6X14, 100, 10, 1)
result103 <- sliding_loreau(X6X15, 100, 10, 1)
result104 <- sliding_loreau(X6X16, 100, 10, 1)
result105 <- sliding_loreau(X6X17, 100, 10, 1)
result106 <- sliding_loreau(X6X18, 100, 10, 1)
result107 <- sliding_loreau(X6X19, 100, 10, 1)
result108 <- sliding_loreau(X6X20, 100, 10, 1)
result109 <- sliding_loreau(X6X21, 100, 10, 1)
result110 <- sliding_loreau(X6X22, 100, 10, 1)
result111 <- sliding_loreau(X6X23, 100, 10, 1)
result112 <- sliding_loreau(X6X24, 100, 10, 1)
result113 <- sliding_loreau(X6X25, 100, 10, 1)
result114 <- sliding_loreau(X6X26, 100, 10, 1)
result115 <- sliding_loreau(X6X27, 100, 10, 1)
result116 <- sliding_loreau(X7X8, 100, 10, 1)
result117 <- sliding_loreau(X7X9, 100, 10, 1)
result118 <- sliding_loreau(X7X10, 100, 10, 1)
result119 <- sliding_loreau(X7X11, 100, 10, 1)
result120 <- sliding_loreau(X7X12, 100, 10, 1)
result121 <- sliding_loreau(X7X13, 100, 10, 1)
result122 <- sliding_loreau(X7X14, 100, 10, 1)
result123 <- sliding_loreau(X7X15, 100, 10, 1)
result124 <- sliding_loreau(X7X16, 100, 10, 1)
result125 <- sliding_loreau(X7X17, 100, 10, 1)
result126 <- sliding_loreau(X7X18, 100, 10, 1)
result127 <- sliding_loreau(X7X19, 100, 10, 1)
result128 <- sliding_loreau(X7X20, 100, 10, 1)
result129 <- sliding_loreau(X7X21, 100, 10, 1)
result130 <- sliding_loreau(X7X22, 100, 10, 1)
result131 <- sliding_loreau(X7X23, 100, 10, 1)
result132 <- sliding_loreau(X7X24, 100, 10, 1)
result133 <- sliding_loreau(X7X25, 100, 10, 1)
result134 <- sliding_loreau(X7X26, 100, 10, 1)
result135 <- sliding_loreau(X7X27, 100, 10, 1)
result136 <- sliding_loreau(X8X9, 100, 10, 1)
result137 <- sliding_loreau(X8X10, 100, 10, 1)
result138 <- sliding_loreau(X8X11, 100, 10, 1)
result139 <- sliding_loreau(X8X12, 100, 10, 1)
result140 <- sliding_loreau(X8X13, 100, 10, 1)
result141 <- sliding_loreau(X8X14, 100, 10, 1)
result142 <- sliding_loreau(X8X15, 100, 10, 1)
result143 <- sliding_loreau(X8X16, 100, 10, 1)
result144 <- sliding_loreau(X8X17, 100, 10, 1)
result145 <- sliding_loreau(X8X18, 100, 10, 1)
result146 <- sliding_loreau(X8X19, 100, 10, 1)
result147 <- sliding_loreau(X8X20, 100, 10, 1)
result148 <- sliding_loreau(X8X21, 100, 10, 1)
result149 <- sliding_loreau(X8X22, 100, 10, 1)
result150 <- sliding_loreau(X8X23, 100, 10, 1)
result151 <- sliding_loreau(X8X24, 100, 10, 1)
result152 <- sliding_loreau(X8X25, 100, 10, 1)
result153 <- sliding_loreau(X8X26, 100, 10, 1)
result154 <- sliding_loreau(X8X27, 100, 10, 1)
result155 <- sliding_loreau(X9X10, 100, 10, 1)
result156 <- sliding_loreau(X9X11, 100, 10, 1)
result157 <- sliding_loreau(X9X12, 100, 10, 1)
result158 <- sliding_loreau(X9X13, 100, 10, 1)
result159 <- sliding_loreau(X9X14, 100, 10, 1)
result160 <- sliding_loreau(X9X15, 100, 10, 1)
result161 <- sliding_loreau(X9X16, 100, 10, 1)
result162 <- sliding_loreau(X9X17, 100, 10, 1)
result163 <- sliding_loreau(X9X18, 100, 10, 1)
result164 <- sliding_loreau(X9X19, 100, 10, 1)
result165 <- sliding_loreau(X9X20, 100, 10, 1)
result166 <- sliding_loreau(X9X21, 100, 10, 1)
result167 <- sliding_loreau(X9X22, 100, 10, 1)
result168 <- sliding_loreau(X9X23, 100, 10, 1)
result169 <- sliding_loreau(X9X24, 100, 10, 1)
result170 <- sliding_loreau(X9X25, 100, 10, 1)
result171 <- sliding_loreau(X9X26, 100, 10, 1)
result172 <- sliding_loreau(X9X27, 100, 10, 1)
result173 <- sliding_loreau(X10X11, 100, 10, 1)
result174 <- sliding_loreau(X10X12, 100, 10, 1)
result175 <- sliding_loreau(X10X13, 100, 10, 1)
result176 <- sliding_loreau(X10X14, 100, 10, 1)
result177 <- sliding_loreau(X10X15, 100, 10, 1)
result178 <- sliding_loreau(X10X16, 100, 10, 1)
result179 <- sliding_loreau(X10X17, 100, 10, 1)
result180 <- sliding_loreau(X10X18, 100, 10, 1)
result181 <- sliding_loreau(X10X19, 100, 10, 1)
result182 <- sliding_loreau(X10X20, 100, 10, 1)
result183 <- sliding_loreau(X10X21, 100, 10, 1)
result184 <- sliding_loreau(X10X22, 100, 10, 1)
result185 <- sliding_loreau(X10X23, 100, 10, 1)
result186 <- sliding_loreau(X10X24, 100, 10, 1)
result187 <- sliding_loreau(X10X25, 100, 10, 1)
result188 <- sliding_loreau(X10X26, 100, 10, 1)
result189 <- sliding_loreau(X10X27, 100, 10, 1)
result190 <- sliding_loreau(X11X12, 100, 10, 1)
result191 <- sliding_loreau(X11X13, 100, 10, 1)
result192 <- sliding_loreau(X11X14, 100, 10, 1)
result193 <- sliding_loreau(X11X15, 100, 10, 1)
result194 <- sliding_loreau(X11X16, 100, 10, 1)
result195 <- sliding_loreau(X11X17, 100, 10, 1)
result196 <- sliding_loreau(X11X18, 100, 10, 1)
result197 <- sliding_loreau(X11X19, 100, 10, 1)
result198 <- sliding_loreau(X11X20, 100, 10, 1)
result199 <- sliding_loreau(X11X21, 100, 10, 1)
result200 <- sliding_loreau(X11X22, 100, 10, 1)
result201 <- sliding_loreau(X11X23, 100, 10, 1)
result202 <- sliding_loreau(X11X24, 100, 10, 1)
result203 <- sliding_loreau(X11X25, 100, 10, 1)
result204 <- sliding_loreau(X11X26, 100, 10, 1)
result205 <- sliding_loreau(X11X27, 100, 10, 1)
result206 <- sliding_loreau(X12X13, 100, 10, 1)
result207 <- sliding_loreau(X12X14, 100, 10, 1)
result208 <- sliding_loreau(X12X15, 100, 10, 1)
result209 <- sliding_loreau(X12X16, 100, 10, 1)
result210 <- sliding_loreau(X12X17, 100, 10, 1)
result211 <- sliding_loreau(X12X18, 100, 10, 1)
result212 <- sliding_loreau(X12X19, 100, 10, 1)
result213 <- sliding_loreau(X12X20, 100, 10, 1)
result214 <- sliding_loreau(X12X21, 100, 10, 1)
result215 <- sliding_loreau(X12X22, 100, 10, 1)
result216 <- sliding_loreau(X12X23, 100, 10, 1)
result217 <- sliding_loreau(X12X24, 100, 10, 1)
result218 <- sliding_loreau(X12X25, 100, 10, 1)
result219 <- sliding_loreau(X12X26, 100, 10, 1)
result220 <- sliding_loreau(X12X27, 100, 10, 1)
result221 <- sliding_loreau(X13X14, 100, 10, 1)
result222 <- sliding_loreau(X13X15, 100, 10, 1)
result223 <- sliding_loreau(X13X16, 100, 10, 1)
result224 <- sliding_loreau(X13X17, 100, 10, 1)
result225 <- sliding_loreau(X13X18, 100, 10, 1)
result226 <- sliding_loreau(X13X19, 100, 10, 1)
result227 <- sliding_loreau(X13X20, 100, 10, 1)
result228 <- sliding_loreau(X13X21, 100, 10, 1)
result229 <- sliding_loreau(X13X22, 100, 10, 1)
result230 <- sliding_loreau(X13X23, 100, 10, 1)
result231 <- sliding_loreau(X13X24, 100, 10, 1)
result232 <- sliding_loreau(X13X25, 100, 10, 1)
result233 <- sliding_loreau(X13X26, 100, 10, 1)
result234 <- sliding_loreau(X13X27, 100, 10, 1)
result235 <- sliding_loreau(X14X15, 100, 10, 1)
result236 <- sliding_loreau(X14X16, 100, 10, 1)
result237 <- sliding_loreau(X14X17, 100, 10, 1)
result238 <- sliding_loreau(X14X18, 100, 10, 1)
result239 <- sliding_loreau(X14X19, 100, 10, 1)
result240 <- sliding_loreau(X14X20, 100, 10, 1)
result241 <- sliding_loreau(X14X21, 100, 10, 1)
result242 <- sliding_loreau(X14X22, 100, 10, 1)
result243 <- sliding_loreau(X14X23, 100, 10, 1)
result244 <- sliding_loreau(X14X24, 100, 10, 1)
result245 <- sliding_loreau(X14X25, 100, 10, 1)
result246 <- sliding_loreau(X14X26, 100, 10, 1)
result247 <- sliding_loreau(X14X27, 100, 10, 1)
result248 <- sliding_loreau(X15X16, 100, 10, 1)
result249 <- sliding_loreau(X15X17, 100, 10, 1)
result250 <- sliding_loreau(X15X18, 100, 10, 1)
result251 <- sliding_loreau(X15X19, 100, 10, 1)
result252 <- sliding_loreau(X15X20, 100, 10, 1)
result253 <- sliding_loreau(X15X21, 100, 10, 1)
result254 <- sliding_loreau(X15X22, 100, 10, 1)
result255 <- sliding_loreau(X15X23, 100, 10, 1)
result256 <- sliding_loreau(X15X24, 100, 10, 1)
result257 <- sliding_loreau(X15X25, 100, 10, 1)
result258 <- sliding_loreau(X15X26, 100, 10, 1)
result259 <- sliding_loreau(X15X27, 100, 10, 1)
result260 <- sliding_loreau(X16X17, 100, 10, 1)
result261 <- sliding_loreau(X16X18, 100, 10, 1)
result262 <- sliding_loreau(X16X19, 100, 10, 1)
result263 <- sliding_loreau(X16X20, 100, 10, 1)
result264 <- sliding_loreau(X16X21, 100, 10, 1)
result265 <- sliding_loreau(X16X22, 100, 10, 1)
result266 <- sliding_loreau(X16X23, 100, 10, 1)
result267 <- sliding_loreau(X16X24, 100, 10, 1)
result268 <- sliding_loreau(X16X25, 100, 10, 1)
result269 <- sliding_loreau(X16X26, 100, 10, 1)
result270 <- sliding_loreau(X16X27, 100, 10, 1)
result271 <- sliding_loreau(X17X18, 100, 10, 1)
result272 <- sliding_loreau(X17X19, 100, 10, 1)
result273 <- sliding_loreau(X17X20, 100, 10, 1)
result274 <- sliding_loreau(X17X21, 100, 10, 1)
result275 <- sliding_loreau(X17X22, 100, 10, 1)
result276 <- sliding_loreau(X17X23, 100, 10, 1)
result277 <- sliding_loreau(X17X24, 100, 10, 1)
result278 <- sliding_loreau(X17X25, 100, 10, 1)
result279 <- sliding_loreau(X17X26, 100, 10, 1)
result280 <- sliding_loreau(X17X27, 100, 10, 1)
result281 <- sliding_loreau(X18X19, 100, 10, 1)
result282 <- sliding_loreau(X18X20, 100, 10, 1)
result283 <- sliding_loreau(X18X21, 100, 10, 1)
result284 <- sliding_loreau(X18X22, 100, 10, 1)
result285 <- sliding_loreau(X18X23, 100, 10, 1)
result286 <- sliding_loreau(X18X24, 100, 10, 1)
result287 <- sliding_loreau(X18X25, 100, 10, 1)
result288 <- sliding_loreau(X18X26, 100, 10, 1)
result289 <- sliding_loreau(X18X27, 100, 10, 1)
result290 <- sliding_loreau(X19X20, 100, 10, 1)
result291 <- sliding_loreau(X19X21, 100, 10, 1)
result292 <- sliding_loreau(X19X22, 100, 10, 1)
result293 <- sliding_loreau(X19X23, 100, 10, 1)
result294 <- sliding_loreau(X19X24, 100, 10, 1)
result295 <- sliding_loreau(X19X25, 100, 10, 1)
result296 <- sliding_loreau(X19X26, 100, 10, 1)
result297 <- sliding_loreau(X19X27, 100, 10, 1)
result298 <- sliding_loreau(X20X21, 100, 10, 1)
result299 <- sliding_loreau(X20X22, 100, 10, 1)
result300 <- sliding_loreau(X20X23, 100, 10, 1)
result301 <- sliding_loreau(X20X24, 100, 10, 1)
result302 <- sliding_loreau(X20X25, 100, 10, 1)
result303 <- sliding_loreau(X20X26, 100, 10, 1)
result304 <- sliding_loreau(X20X27, 100, 10, 1)
result305 <- sliding_loreau(X21X22, 100, 10, 1)
result306 <- sliding_loreau(X21X23, 100, 10, 1)
result307 <- sliding_loreau(X21X24, 100, 10, 1)
result308 <- sliding_loreau(X21X25, 100, 10, 1)
result309 <- sliding_loreau(X21X26, 100, 10, 1)
result310 <- sliding_loreau(X21X27, 100, 10, 1)
result311 <- sliding_loreau(X22X23, 100, 10, 1)
result312 <- sliding_loreau(X22X24, 100, 10, 1)
result313 <- sliding_loreau(X22X25, 100, 10, 1)
result314 <- sliding_loreau(X22X26, 100, 10, 1)
result315 <- sliding_loreau(X22X27, 100, 10, 1)
result316 <- sliding_loreau(X23X24, 100, 10, 1)
result317 <- sliding_loreau(X23X25, 100, 10, 1)
result318 <- sliding_loreau(X23X26, 100, 10, 1)
result319 <- sliding_loreau(X23X27, 100, 10, 1)
result320 <- sliding_loreau(X24X25, 100, 10, 1)
result321 <- sliding_loreau(X24X26, 100, 10, 1)
result322 <- sliding_loreau(X24X27, 100, 10, 1)
result323 <- sliding_loreau(X25X26, 100, 10, 1)
result324 <- sliding_loreau(X25X27, 100, 10, 1)
result325 <- sliding_loreau(X26X27, 100, 10, 1)

write.csv(result1, file = "result1.csv")
write.csv(result2, file = "result2.csv")
write.csv(result3, file = "result3.csv")
write.csv(result4, file = "result4.csv")
write.csv(result5, file = "result5.csv")
write.csv(result6, file = "result6.csv")
write.csv(result7, file = "result7.csv")
write.csv(result8, file = "result8.csv")
write.csv(result9, file = "result9.csv")
write.csv(result10, file = "result10.csv")
write.csv(result11, file = "result11.csv")
write.csv(result12, file = "result12.csv")
write.csv(result13, file = "result13.csv")
write.csv(result14, file = "result14.csv")
write.csv(result15, file = "result15.csv")
write.csv(result16, file = "result16.csv")
write.csv(result17, file = "result17.csv")
write.csv(result18, file = "result18.csv")
write.csv(result19, file = "result19.csv")
write.csv(result20, file = "result20.csv")
write.csv(result21, file = "result21.csv")
write.csv(result22, file = "result22.csv")
write.csv(result23, file = "result23.csv")
write.csv(result24, file = "result24.csv")
write.csv(result25, file = "result25.csv")
write.csv(result26, file = "result26.csv")
write.csv(result27, file = "result27.csv")
write.csv(result28, file = "result28.csv")
write.csv(result29, file = "result29.csv")
write.csv(result30, file = "result30.csv")
write.csv(result31, file = "result31.csv")
write.csv(result32, file = "result32.csv")
write.csv(result33, file = "result33.csv")
write.csv(result34, file = "result34.csv")
write.csv(result35, file = "result35.csv")
write.csv(result36, file = "result36.csv")
write.csv(result37, file = "result37.csv")
write.csv(result38, file = "result38.csv")
write.csv(result39, file = "result39.csv")
write.csv(result40, file = "result40.csv")
write.csv(result41, file = "result41.csv")
write.csv(result42, file = "result42.csv")
write.csv(result43, file = "result43.csv")
write.csv(result44, file = "result44.csv")
write.csv(result45, file = "result45.csv")
write.csv(result46, file = "result46.csv")
write.csv(result47, file = "result47.csv")
write.csv(result48, file = "result48.csv")
write.csv(result49, file = "result49.csv")
write.csv(result50, file = "result50.csv")
write.csv(result51, file = "result51.csv")
write.csv(result52, file = "result52.csv")
write.csv(result53, file = "result53.csv")
write.csv(result54, file = "result54.csv")
write.csv(result55, file = "result55.csv")
write.csv(result56, file = "result56.csv")
write.csv(result57, file = "result57.csv")
write.csv(result58, file = "result58.csv")
write.csv(result59, file = "result59.csv")
write.csv(result60, file = "result60.csv")
write.csv(result61, file = "result61.csv")
write.csv(result62, file = "result62.csv")
write.csv(result63, file = "result63.csv")
write.csv(result64, file = "result64.csv")
write.csv(result65, file = "result65.csv")
write.csv(result66, file = "result66.csv")
write.csv(result67, file = "result67.csv")
write.csv(result68, file = "result68.csv")
write.csv(result69, file = "result69.csv")
write.csv(result70, file = "result70.csv")
write.csv(result71, file = "result71.csv")
write.csv(result72, file = "result72.csv")
write.csv(result73, file = "result73.csv")
write.csv(result74, file = "result74.csv")
write.csv(result75, file = "result75.csv")
write.csv(result76, file = "result76.csv")
write.csv(result77, file = "result77.csv")
write.csv(result78, file = "result78.csv")
write.csv(result79, file = "result79.csv")
write.csv(result80, file = "result80.csv")
write.csv(result81, file = "result81.csv")
write.csv(result82, file = "result82.csv")
write.csv(result83, file = "result83.csv")
write.csv(result84, file = "result84.csv")
write.csv(result85, file = "result85.csv")
write.csv(result86, file = "result86.csv")
write.csv(result87, file = "result87.csv")
write.csv(result88, file = "result88.csv")
write.csv(result89, file = "result89.csv")
write.csv(result90, file = "result90.csv")
write.csv(result91, file = "result91.csv")
write.csv(result92, file = "result92.csv")
write.csv(result93, file = "result93.csv")
write.csv(result94, file = "result94.csv")
write.csv(result95, file = "result95.csv")
write.csv(result96, file = "result96.csv")
write.csv(result97, file = "result97.csv")
write.csv(result98, file = "result98.csv")
write.csv(result99, file = "result99.csv")
write.csv(result100, file = "result100.csv")
write.csv(result101, file = "result101.csv")
write.csv(result102, file = "result102.csv")
write.csv(result103, file = "result103.csv")
write.csv(result104, file = "result104.csv")
write.csv(result105, file = "result105.csv")
write.csv(result106, file = "result106.csv")
write.csv(result107, file = "result107.csv")
write.csv(result108, file = "result108.csv")
write.csv(result109, file = "result109.csv")
write.csv(result110, file = "result110.csv")
write.csv(result111, file = "result111.csv")
write.csv(result112, file = "result112.csv")
write.csv(result113, file = "result113.csv")
write.csv(result114, file = "result114.csv")
write.csv(result115, file = "result115.csv")
write.csv(result116, file = "result116.csv")
write.csv(result117, file = "result117.csv")
write.csv(result118, file = "result118.csv")
write.csv(result119, file = "result119.csv")
write.csv(result120, file = "result120.csv")
write.csv(result121, file = "result121.csv")
write.csv(result122, file = "result122.csv")
write.csv(result123, file = "result123.csv")
write.csv(result124, file = "result124.csv")
write.csv(result125, file = "result125.csv")
write.csv(result126, file = "result126.csv")
write.csv(result127, file = "result127.csv")
write.csv(result128, file = "result128.csv")
write.csv(result129, file = "result129.csv")
write.csv(result130, file = "result130.csv")
write.csv(result131, file = "result131.csv")
write.csv(result132, file = "result132.csv")
write.csv(result133, file = "result133.csv")
write.csv(result134, file = "result134.csv")
write.csv(result135, file = "result135.csv")
write.csv(result136, file = "result136.csv")
write.csv(result137, file = "result137.csv")
write.csv(result138, file = "result138.csv")
write.csv(result139, file = "result139.csv")
write.csv(result140, file = "result140.csv")
write.csv(result141, file = "result141.csv")
write.csv(result142, file = "result142.csv")
write.csv(result143, file = "result143.csv")
write.csv(result144, file = "result144.csv")
write.csv(result145, file = "result145.csv")
write.csv(result146, file = "result146.csv")
write.csv(result147, file = "result147.csv")
write.csv(result148, file = "result148.csv")
write.csv(result149, file = "result149.csv")
write.csv(result150, file = "result150.csv")
write.csv(result151, file = "result151.csv")
write.csv(result152, file = "result152.csv")
write.csv(result153, file = "result153.csv")
write.csv(result154, file = "result154.csv")
write.csv(result155, file = "result155.csv")
write.csv(result156, file = "result156.csv")
write.csv(result157, file = "result157.csv")
write.csv(result158, file = "result158.csv")
write.csv(result159, file = "result159.csv")
write.csv(result160, file = "result160.csv")
write.csv(result161, file = "result161.csv")
write.csv(result162, file = "result162.csv")
write.csv(result163, file = "result163.csv")
write.csv(result164, file = "result164.csv")
write.csv(result165, file = "result165.csv")
write.csv(result166, file = "result166.csv")
write.csv(result167, file = "result167.csv")
write.csv(result168, file = "result168.csv")
write.csv(result169, file = "result169.csv")
write.csv(result170, file = "result170.csv")
write.csv(result171, file = "result171.csv")
write.csv(result172, file = "result172.csv")
write.csv(result173, file = "result173.csv")
write.csv(result174, file = "result174.csv")
write.csv(result175, file = "result175.csv")
write.csv(result176, file = "result176.csv")
write.csv(result177, file = "result177.csv")
write.csv(result178, file = "result178.csv")
write.csv(result179, file = "result179.csv")
write.csv(result180, file = "result180.csv")
write.csv(result181, file = "result181.csv")
write.csv(result182, file = "result182.csv")
write.csv(result183, file = "result183.csv")
write.csv(result184, file = "result184.csv")
write.csv(result185, file = "result185.csv")
write.csv(result186, file = "result186.csv")
write.csv(result187, file = "result187.csv")
write.csv(result188, file = "result188.csv")
write.csv(result189, file = "result189.csv")
write.csv(result190, file = "result190.csv")
write.csv(result191, file = "result191.csv")
write.csv(result192, file = "result192.csv")
write.csv(result193, file = "result193.csv")
write.csv(result194, file = "result194.csv")
write.csv(result195, file = "result195.csv")
write.csv(result196, file = "result196.csv")
write.csv(result197, file = "result197.csv")
write.csv(result198, file = "result198.csv")
write.csv(result199, file = "result199.csv")
write.csv(result200, file = "result200.csv")
write.csv(result201, file = "result201.csv")
write.csv(result202, file = "result202.csv")
write.csv(result203, file = "result203.csv")
write.csv(result204, file = "result204.csv")
write.csv(result205, file = "result205.csv")
write.csv(result206, file = "result206.csv")
write.csv(result207, file = "result207.csv")
write.csv(result208, file = "result208.csv")
write.csv(result209, file = "result209.csv")
write.csv(result210, file = "result210.csv")
write.csv(result211, file = "result211.csv")
write.csv(result212, file = "result212.csv")
write.csv(result213, file = "result213.csv")
write.csv(result214, file = "result214.csv")
write.csv(result215, file = "result215.csv")
write.csv(result216, file = "result216.csv")
write.csv(result217, file = "result217.csv")
write.csv(result218, file = "result218.csv")
write.csv(result219, file = "result219.csv")
write.csv(result220, file = "result220.csv")
write.csv(result221, file = "result221.csv")
write.csv(result222, file = "result222.csv")
write.csv(result223, file = "result223.csv")
write.csv(result224, file = "result224.csv")
write.csv(result225, file = "result225.csv")
write.csv(result226, file = "result226.csv")
write.csv(result227, file = "result227.csv")
write.csv(result228, file = "result228.csv")
write.csv(result229, file = "result229.csv")
write.csv(result230, file = "result230.csv")
write.csv(result231, file = "result231.csv")
write.csv(result232, file = "result232.csv")
write.csv(result233, file = "result233.csv")
write.csv(result234, file = "result234.csv")
write.csv(result235, file = "result235.csv")
write.csv(result236, file = "result236.csv")
write.csv(result237, file = "result237.csv")
write.csv(result238, file = "result238.csv")
write.csv(result239, file = "result239.csv")
write.csv(result240, file = "result240.csv")
write.csv(result241, file = "result241.csv")
write.csv(result242, file = "result242.csv")
write.csv(result243, file = "result243.csv")
write.csv(result244, file = "result244.csv")
write.csv(result245, file = "result245.csv")
write.csv(result246, file = "result246.csv")
write.csv(result247, file = "result247.csv")
write.csv(result248, file = "result248.csv")
write.csv(result249, file = "result249.csv")
write.csv(result250, file = "result250.csv")
write.csv(result251, file = "result251.csv")
write.csv(result252, file = "result252.csv")
write.csv(result253, file = "result253.csv")
write.csv(result254, file = "result254.csv")
write.csv(result255, file = "result255.csv")
write.csv(result256, file = "result256.csv")
write.csv(result257, file = "result257.csv")
write.csv(result258, file = "result258.csv")
write.csv(result259, file = "result259.csv")
write.csv(result260, file = "result260.csv")
write.csv(result261, file = "result261.csv")
write.csv(result262, file = "result262.csv")
write.csv(result263, file = "result263.csv")
write.csv(result264, file = "result264.csv")
write.csv(result265, file = "result265.csv")
write.csv(result266, file = "result266.csv")
write.csv(result267, file = "result267.csv")
write.csv(result268, file = "result268.csv")
write.csv(result269, file = "result269.csv")
write.csv(result270, file = "result270.csv")
write.csv(result271, file = "result271.csv")
write.csv(result272, file = "result272.csv")
write.csv(result273, file = "result273.csv")
write.csv(result274, file = "result274.csv")
write.csv(result275, file = "result275.csv")
write.csv(result276, file = "result276.csv")
write.csv(result277, file = "result277.csv")
write.csv(result278, file = "result278.csv")
write.csv(result279, file = "result279.csv")
write.csv(result280, file = "result280.csv")
write.csv(result281, file = "result281.csv")
write.csv(result282, file = "result282.csv")
write.csv(result283, file = "result283.csv")
write.csv(result284, file = "result284.csv")
write.csv(result285, file = "result285.csv")
write.csv(result286, file = "result286.csv")
write.csv(result287, file = "result287.csv")
write.csv(result288, file = "result288.csv")
write.csv(result289, file = "result289.csv")
write.csv(result290, file = "result290.csv")
write.csv(result291, file = "result291.csv")
write.csv(result292, file = "result292.csv")
write.csv(result293, file = "result293.csv")
write.csv(result294, file = "result294.csv")
write.csv(result295, file = "result295.csv")
write.csv(result296, file = "result296.csv")
write.csv(result297, file = "result297.csv")
write.csv(result298, file = "result298.csv")
write.csv(result299, file = "result299.csv")
write.csv(result300, file = "result300.csv")
write.csv(result301, file = "result301.csv")
write.csv(result302, file = "result302.csv")
write.csv(result303, file = "result303.csv")
write.csv(result304, file = "result304.csv")
write.csv(result305, file = "result305.csv")
write.csv(result306, file = "result306.csv")
write.csv(result307, file = "result307.csv")
write.csv(result308, file = "result308.csv")
write.csv(result309, file = "result309.csv")
write.csv(result310, file = "result310.csv")
write.csv(result311, file = "result311.csv")
write.csv(result312, file = "result312.csv")
write.csv(result313, file = "result313.csv")
write.csv(result314, file = "result314.csv")
write.csv(result315, file = "result315.csv")
write.csv(result316, file = "result316.csv")
write.csv(result317, file = "result317.csv")
write.csv(result318, file = "result318.csv")
write.csv(result319, file = "result319.csv")
write.csv(result320, file = "result320.csv")
write.csv(result321, file = "result321.csv")
write.csv(result322, file = "result322.csv")
write.csv(result323, file = "result323.csv")
write.csv(result324, file = "result324.csv")
write.csv(result325, file = "result325.csv")

#Extract the fifth column from all csv files
# Retrieve all csv files in the directory
file_list <- list.files(pattern = "*.csv")

# Initialize an empty list to store data
data_list <- list()

# Read the fourth column of each file in a loop
for (file in file_list) {
  temp_data <- read.csv(file)
  if(ncol(temp_data) >= 4) {
    data_list[[file]] <- temp_data[,4]
  } else {
    warning(paste("File", file, "has less than 4 columns"))
  }
}

# Combine all columns into one data frame
merged_data <- data.frame(do.call(cbind, data_list))

# Add the file name as the column name (remove the .csv suffix)
colnames(merged_data) <- gsub(".csv", "", file_list)

# View merge results
#print(head(merged_data))

write.csv(merged_data, file = "merged_data.csv")
#Calculate the mean value of biological abundance in each window and insert it into the first column of merged_data
X1 <- data$X1

# Sliding window mean calculation function
sliding_window_mean <- function(data, window_size=100, step=10, start=1) {
  n <- length(data)
  end <- n - window_size + 1
  positions <- seq(start, end, by=step)
  
  sapply(positions, function(i) {
    window <- data[i:(i+window_size-1)]
    mean(window, na.rm=TRUE)
  })
}
cyamean <- sliding_window_mean(X1)

merged_data_microcystis <- cbind(cyamean, merged_data)
colnames(merged_data_microcystis)[1] <- "microcystis"  # Rename the first column

write.csv(merged_data_microcystis, file = "merged_data_microcystis.csv")

# Calculate the Spearman correlation coefficient and P value between the first column and each of the other columns
calculate_spearman <- function(data, output_file = "spearman_results.csv") {
  if(ncol(data) < 2) stop("The data needs at least two columns")
  
  results <- data.frame(
    Target_Column = colnames(data)[1],
    Compared_Column = colnames(data)[-1],
    spearman_Correlation = numeric(ncol(data)-1),
    P_value = numeric(ncol(data)-1),
    stringsAsFactors = FALSE
  )
  
  for(i in 2:ncol(data)) {
    test_result <- suppressWarnings(
      cor.test(data[[1]], data[[i]], 
               method = "spearman",  
               exact = FALSE)
    )
    results$spearman_Correlation[i-1] <- round(test_result$estimate, 4)
    results$P_value[i-1] <- format.pval(test_result$p.value, digits = 4)
  }
  
  write.csv(results, output_file, row.names = FALSE)
  message(paste("The result has been saved to:", output_file))
  return(results)
}

my_data <- read.csv("merged_data_microcystis.csv", row.names = 1, header = TRUE)
calculate_spearman(my_data)
